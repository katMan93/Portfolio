
# !/bin/bash

# This script checks the system for instances of virtualized hardware and
#  runs a Python script to analyze the results

# Get CPU data and use grep to find instances of VMware
cpuid > data.txt
grep -i -c "vmware" data.txt > scoreTracker.txt

# Get network interface data and use grep to find the standard VMware MAC address
ifconfig -a > data.txt
grep -i -c "00:0c:29:a3:30:43" data.txt >> scoreTracker.txt

# Get PCI data and use grep to find instances of VMware
lspci -nn > data.txt
grep -i -c "vmware" data.txt >> scoreTracker.txt

# Get removable device driver data and use grep to search for instances of VMware
lsusb > data.txt
grep -i -c "vmware" data.txt >> scoreTracker.txt

# The methods below require root access and the use of the "sudo" command

# Get BIOS info and use grep to find instances of VMware
sudo dmidecode | less > data.txt
grep -i -c "vmware" data.txt >> scoreTracker.txt

# Get SCSI info and use grep to find instances of VMware
# This method also requires that sdparm be installed on the machine
sudo sdparm -a /dev/sda1 > data.txt
grep -i -c "vmware" data.txt >> scoreTracker.txt

# Get hard drive temperature and use grep to find instances of VMware
# This method also requires that hddtemp be installed on the machine
sudo hddtemp /dev/sda1 > data.txt
grep -i -c "vmware" data.txt >> scoreTracker.txt

# Run Python program to parse through scoreTracker.txt and output the verdict
python ./results.py
